{% extends "base.html" %}
{% block includes %}
<script src="https://cdn.jsdelivr.net/npm/tom-select/dist/js/tom-select.complete.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/tom-select/dist/css/tom-select.css" rel="stylesheet"/>
<script src="{{ url_for('static', path='js/template_scan.js') }}"></script>

{% endblock %}
{% block body %}
<meta id="javascript_data" data-selected_scans="{{selected_scans|join(',')}}">
<nav
  class="block text-sm text-left text-green-800 h-12 flex items-center p-4 mb-5 border-2 border-gray-500"
  role="alert"
>
  <ol class="list-reset flex text-grey-dark">
    <li><a href="/{{ lang }}" class="font-bold">{{home_locale}}</a></li>
    <li><span class="mx-2">/</span></li>
    <li><a href="/{{ lang }}/template" class="font-bold">{{templates_locale}}</a></li>
    <li><span class="mx-2">/</span></li>
    <li><a href="/{{ lang }}/template/{{template.id}}/scan" class="font-bold">{{template.name}}</a></li>
    <li><span class="mx-2">/</span></li>
    {% if template_scan %}
      <li>{{update_scan_locale}}</li>
    {% else %}
      <li>{{add_new_scan_locale}}</li>
    {% endif %}
  </ol>
</nav>
<div class="relative flex py-5 items-center">
  <div class="flex-grow border-t border-gray-400"></div>
  <span class="flex-shrink mx-4 text-gray-400"><strong>{{ name_locale }}</strong>: {{ template.name }}</span>
  <div class="flex-grow border-t border-gray-400"></div>
</div>
<form id="templateScan" name="templateScan" action="/scans/template/{{template.id}}/scan" method="POST">
<div class="container">
  <div class="grid lg:grid-cols-3 md:grid-cols-2 gap-8 w-full max-w-screen-lg">
    <div class="lg:col-span-2">
      <div class="col-span-2">
        <label class="text-xs font-bold" for="url">URL to be scanned</label><label class="pl-1 text-red-700 text-xs font-bold" for="url">(required)</label>
        <input class="flex items-center h-10 border mt-1 rounded px-4 w-full text-sm" value="{{template_scan.data['url']}}" type="text" placeholder="https://digital.canada.ca">  
      </div>
      <div class="gap-8 mt-4">
        <label class="text-xs font-bold" >Scan options </label>
      </div>
      <div class="bg-white rounded  shadow-lg">
        <div class="flex items-center px-8 py-5">
          <input id="crawl_scan" class="w-4 h-4 rounded-full border-2 border-white" name="crawl" type="checkbox">
          <label for="crawl_scan" class="text-sm font-medium ml-4">Crawl</label>
        </div>
      </div>
      <div x-data="services()">
      <div class="relative flex py-5 items-center">
        <div class="flex-grow border-t border-gray-400"></div>
        <span class="flex-shrink mx-4 text-gray-400">URL exclusion rules</span>
        <div class="flex-grow border-t border-gray-400"></div>
      </div>
      <div class="flex space-x-2" x-data="services()">
        <input id="regex" type="text" class="px-2 py-1 border flex-1 rounded" placeholder="URL regular expression">
        <button type="button" class="border bg-blue-600 hover:bg-blue-700 text-white rounded px-4 py-1" onclick="addExclusion();">Add
        exclusion</button>
      </div>
      <div class="rounded border mt-4 text-xs">
        <table id="dataTable" class="w-full">
          <thead>
            <tr>
              <th class="bg-gray-100 font-normal text-gray-500 uppercase py-2">Excluded</th>
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
      </div>
      </div>
    </div>
    <div>
      <h2 class="text-xs font-bold">Scans to run</h2>
      <div class="bg-white rounded mt-4 shadow-lg py-6">
        <div class="px-8">
          <div class="relative flex w-full">
            <select
              id="select-scans"
              name="scans[]"
              multiple
              placeholder="Select scans..."
              autocomplete="off"
              class="block w-full rounded-sm cursor-pointer focus:outline-none"
              >
              {% for scan_type in scan_types %}
              <option id="{{ scan_type.id }}" value="{{ scan_type.name }}" aria-label="{{ scan_type.name }}">{{ scan_type.name }}</option>
              {% endfor %}
            </select>
          </div>
        </div>
        <div class="px-8 mt-4 border-t pt-4">
        </div>
        <div class="flex flex-col px-8 pt-2">
          <button class="flex items-center justify-center bg-green-600 text-sm font-medium w-full h-10 rounded text-blue-50 hover:bg-green-700">Save</button>
        </div>
      </div>
    </div>
  </div>
</div>
</form>
{% block footer %}
{{super()}}
{% endblock %}
{% endblock %}