{% extends "base.html" %}
{% block body %}
  <nav
    class="block text-sm text-left text-green-800 h-12 flex items-center p-4 mb-5 border-2 border-gray-500"
    role="alert"
  >
    <ol class="list-reset flex text-grey-dark">
      <li>
        <a href="/{{ lang }}" class="font-bold">{{home_locale}}</a>
      </li>
    </ol>
  </nav>
  {% if request.session.user is defined %}
    <a href="/{{ lang }}/template" class="button flex-shrink-0 bg-green-500 hover:bg-green-700 border-green-500 hover:border-green-700 text-sm border-4 text-black py-1 px-2 rounded float-right">{{ add_template_locale }}</a>
  {% endif %}
  <h1 class="text-gray-700 font-semibold uppercase text-xl mb-7">{{ list_of_products_locale }}</h1>
  <hr class="my-3"/>
  <div class="space-y-4">
    {% for template in template_list %}
      <div class="shadow-lg p-4 bg-white relative overflow-hidden">
        <div class="flex items-center border-b-2 mb-5 py-2">
          <h2 class="text-gray-800 tracking-wider">{{ template.name }}</h2>
        </div>
        {% if template.scans | length > 0 %}
          <div class="grid gap-6 mb-8 md:grid-cols-2 xl:grid-cols-4">
            {% for scan in template.scans %}
              {% if scan.security_reports %}
                <div class="flex items-start p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800 border-2	">
                  <div>
                    <div class="p-3 mr-4 text-red-500 bg-red-100 rounded-full dark:text-red-100 dark:bg-red-500">
                      {% if scan.scan_type.name == "Nuclei" %}
                      <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"	 width="24px" height="24px" viewBox="0 0 46.334 46.334" style="enable-background:new 0 0 46.334 46.334;"	 xml:space="preserve"><g>	<g>		<path d="M41.656,23.167c2.873-3.743,3.711-7.315,2.352-10.118c-1.383-2.847-4.819-4.415-9.678-4.415			c-0.692,0-1.409,0.04-2.139,0.101C30.109,3.385,26.87,0,23.166,0c-3.704,0-6.943,3.384-9.025,8.735			c-0.728-0.062-1.445-0.101-2.138-0.101c-4.858,0-8.295,1.568-9.677,4.415c-1.36,2.803-0.521,6.375,2.352,10.118			c-2.873,3.742-3.712,7.315-2.352,10.118c1.382,2.848,4.819,4.415,9.676,4.415c0.693,0,1.411-0.04,2.139-0.101			c2.082,5.351,5.321,8.734,9.025,8.734c3.704,0,6.943-3.384,9.025-8.734c0.729,0.062,1.446,0.101,2.139,0.101h0.001			c4.857,0,8.293-1.567,9.676-4.415C45.368,30.483,44.529,26.909,41.656,23.167z M34.33,11.635c3.595,0,6.138,0.993,6.979,2.725			c0.778,1.603,0.162,3.933-1.677,6.5c-1.562-1.596-3.414-3.132-5.496-4.553c-0.242-1.63-0.57-3.177-0.972-4.625			C33.558,11.659,33.952,11.635,34.33,11.635z M26.862,30.778c-1.222,0.593-2.46,1.122-3.696,1.59			c-1.235-0.468-2.474-0.997-3.695-1.59c-1.576-0.765-3.065-1.608-4.468-2.5c-0.187-1.615-0.299-3.315-0.299-5.112			c0-1.796,0.112-3.497,0.299-5.112c1.403-0.891,2.892-1.734,4.468-2.499c1.222-0.593,2.46-1.122,3.695-1.59			c1.236,0.468,2.475,0.997,3.696,1.59c1.575,0.765,3.064,1.607,4.466,2.499c0.188,1.615,0.3,3.317,0.3,5.113			s-0.112,3.497-0.3,5.112C29.928,29.17,28.438,30.014,26.862,30.778z M30.685,32.156c-0.165,0.746-0.346,1.462-0.547,2.145			c-0.842-0.144-1.7-0.321-2.576-0.543c0.204-0.097,0.408-0.182,0.611-0.279C29.033,33.059,29.866,32.614,30.685,32.156z			 M18.771,33.758c-0.876,0.222-1.734,0.399-2.577,0.543c-0.201-0.683-0.382-1.399-0.547-2.146c0.818,0.458,1.651,0.903,2.513,1.321			C18.364,33.576,18.568,33.661,18.771,33.758z M11.789,26.006c-1.163-0.916-2.229-1.867-3.158-2.839			c0.929-0.973,1.995-1.922,3.158-2.839c-0.054,0.93-0.085,1.875-0.085,2.839S11.735,25.076,11.789,26.006z M15.648,14.178			c0.165-0.746,0.346-1.463,0.547-2.146c0.842,0.145,1.7,0.322,2.576,0.544c-0.203,0.095-0.407,0.18-0.61,0.279			C17.299,13.275,16.466,13.72,15.648,14.178z M27.562,12.577c0.876-0.222,1.734-0.4,2.576-0.544c0.2,0.683,0.382,1.399,0.547,2.145			c-0.818-0.458-1.651-0.904-2.512-1.322C27.971,12.758,27.766,12.673,27.562,12.577z M34.544,20.326			c1.162,0.918,2.229,1.867,3.158,2.84c-0.929,0.973-1.996,1.922-3.158,2.84c0.054-0.93,0.085-1.875,0.085-2.84			C34.629,22.202,34.597,21.257,34.544,20.326z M23.166,3c2.097,0,4.312,2.288,5.953,6.159c-1.928,0.358-3.927,0.902-5.952,1.616			c-2.025-0.714-4.024-1.257-5.952-1.616C18.854,5.288,21.07,3,23.166,3z M5.025,14.36c0.84-1.732,3.384-2.725,6.978-2.725			c0.377,0,0.772,0.025,1.166,0.046c-0.402,1.449-0.729,2.996-0.971,4.626c-2.082,1.421-3.935,2.957-5.495,4.553			C4.862,18.292,4.246,15.963,5.025,14.36z M12.002,34.699c-3.593,0-6.137-0.993-6.977-2.725c-0.779-1.604-0.163-3.934,1.678-6.5			c1.56,1.596,3.413,3.132,5.495,4.553c0.242,1.63,0.57,3.178,0.971,4.626C12.775,34.676,12.379,34.699,12.002,34.699z			 M23.166,43.334c-2.096,0-4.312-2.287-5.952-6.158c1.928-0.358,3.927-0.902,5.953-1.617c2.025,0.715,4.024,1.258,5.952,1.617			C27.479,41.047,25.263,43.334,23.166,43.334z M41.309,31.975c-0.84,1.731-3.383,2.725-6.978,2.725l0,0			c-0.377,0-0.772-0.025-1.167-0.046c0.401-1.449,0.729-2.996,0.972-4.626c2.083-1.421,3.936-2.958,5.497-4.553			C41.471,28.041,42.088,30.371,41.309,31.975z"/>		<circle cx="23.166" cy="23.167" r="4.652"/>	</g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg>
                      {% else %}
                      <svg width="24px" height="24px" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path fill="#000" d="M20.72 19.34v39.72L151.6 132.9l94.9-45.12L151 19.34H20.72zm196.98.1L313 76.78C226.5 118 135.1 161.4 57.53 198.3l161.57 86.1 59.6-39.2-39.4-34.9c82.3-40.6 168.3-83.5 241.8-119.93l-93.6-70.93H217.7zM361.9 170.5l-76.5 37.9 44.9 25.3c-54.2 35.6-111.8 73.6-160.6 105.7l325.2 154.8L307.5 347c57.6-32.3 117.5-65.9 168.8-94.6l-114.4-81.9zm13.2 160.1l-33.9 18.9 139.3 74.3c-35.1-31.1-70.3-62.2-105.4-93.2z"/></svg>
                      {% endif %}
                    </div>
                  </div>
                  <div class="w-full">
                    <table class="table-auto w-full">
                      <tbody>
                        <tr>
                          <td class="py-1 text-sm font-medium text-gray-600 dark:text-gray-400 ">
                            {% if request.session.user is not defined %}
                              {{ scan.scan_type.name }}
                            {% else %}
                              <a href="/{{ lang }}/results/{{ template.id }}/scan/{{ scan.id }}">{{ scan.scan_type.name }}</a>
                            {% endif %}
                          </td>
                        </tr>
                        <tr>
                          <td class="py-1">{{ reports_locale }}</td>
                          <td class="py-1">{{ scan.security_reports | length }}</td>
                        </tr>
                        <tr>
                          <td class="py-1">{{ violations_locale }}</td>
                          <td class="py-1">{{ scan.security_reports[0].security_violations | length }}</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              {% endif %}
              {% if scan.a11y_reports %}
                <div class="flex items-start p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800 border-2	">
                  <div>
                    <div class="p-3 mr-4 text-blue-500 bg-blue-100 rounded-full dark:text-blue-100 dark:bg-blue-500">
                      <svg width="24px" height="24px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M7 9L12 10M17 9L12 10M12 10V13M12 13L10 18M12 13L14 18" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12 7C11.7239 7 11.5 6.77614 11.5 6.5C11.5 6.22386 11.7239 6 12 6C12.2761 6 12.5 6.22386 12.5 6.5C12.5 6.77614 12.2761 7 12 7Z" fill="black" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </div>
                  </div>
                  <div class="w-full">
                    <table class="table-auto w-full">
                      <tbody>
                        <tr>
                          <td class="py-1 text-sm font-medium text-gray-600 dark:text-gray-400 ">
                            {% if request.session.user is not defined %}
                              {{ scan.scan_type.name }}
                            {% else %}
                              <a href="/{{ lang }}/results/{{ template.id }}/scan/{{ scan.id }}">{{ scan.scan_type.name }}</a>
                            {% endif %}
                          </td>
                          <td class="py-1"></td>
                        </tr>
                        <tr>
                          <td class="py-1">{{ reports_locale }}</td>
                          <td class="py-1">{{ scan.a11y_reports | length }}</td>
                        </tr>
                        <tr>
                          <td class="py-1">{{ violations_locale }}</td>
                          <td class="py-1">{{ scan.a11y_reports[0].a11y_violations | length }}</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              {% endif %}
            {% endfor %}
          </div>
        {% endif %}
      </div>
    {% endfor %}
  </div>
</div>

{% block footer %}
  {{super()}}
{% endblock %}
{% endblock %}